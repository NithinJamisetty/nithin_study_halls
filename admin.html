<!DOCTYPE html>
<html>

<head>
  <title>Nithin Study Halls - Admin</title>
  <link rel="stylesheet" href="admin.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>

  <!-- BACKGROUND -->
  <div class="admin-bg"></div>

  <!-- LOGIN -->
  <div id="loginPage" class="login-split">

    <!-- Left Side: Login Form -->
    <div class="login-split-left">
      <!-- Brand -->
      <div class="split-brand">
        <svg width="32" height="32" viewBox="0 0 36 36" fill="none">
          <rect width="36" height="36" rx="10" fill="#2D3748" />
          <path d="M10 18L16 24L26 12" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
        <span>Nithin<b>Halls</b></span>
      </div>

      <div class="login-left-content">
        <h1 class="split-title">Admin Portal</h1>
        <p class="split-subtitle">Welcome back. Please log in to your account to manage students, seats, and the study
          environment.</p>

        <!-- Form -->
        <div class="split-form">
          <div class="split-input-group">
            <label for="username">Username</label>
            <input type="text" id="username" placeholder="Enter your username">
          </div>
          <div class="split-input-group">
            <label for="password">Password</label>
            <input type="password" id="password" placeholder="••••••••">
          </div>
          <button onclick="login()" class="split-btn">Sign in to Dashboard</button>
        </div>

        <div class="split-footer">
          <a href="index.html">&larr; Return to main site</a>
        </div>
      </div>
    </div>

    <!-- Right Side: Image -->
    <div class="login-split-right">
      <div class="img-box-wrapper">
        <img src="login_split_img.png" alt="Students studying together">
      </div>
    </div>

  </div>

  <!-- DASHBOARD -->
  <div id="adminPanel" class="glass-panel" style="display:none;">

    <header class="admin-header">
      <div class="logo"
        style="font-size: 22px; font-weight: 700; letter-spacing: -0.5px; display: flex; align-items: center; gap: 8px;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect width="24" height="24" rx="8" fill="var(--accent-primary)" />
          <path d="M7 12L10.5 15.5L18 8" stroke="white" stroke-width="2.5" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        Nithin<span style="color: var(--accent-primary);">Halls</span>
      </div>
      <div class="admin-clock">
        <span>Live Time: </span>
        <span id="adminClock"></span>
      </div>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </header>



    <!-- DASHBOARD HOME (3 Cards) -->
    <div id="dashboardHome" class="dash-home-grid">
      <div class="dash-home-card" onclick="openHomeSection('seats')">
        <div class="dash-card-img-wrapper">
          <img src="dash_seat_management.png" alt="Seat Management">
        </div>
        <h2>Seat Management</h2>
        <p>Monitor AC and Non-AC sections, manage availability.</p>
      </div>

      <div class="dash-home-card" onclick="openHomeSection('users')">
        <div class="dash-card-img-wrapper">
          <img src="dash_users.png" alt="Users">
        </div>
        <h2>Registered Users</h2>
        <p>View student records, add new members, manage subscriptions.</p>
      </div>

      <div class="dash-home-card" onclick="openHomeSection('enquiries')">
        <div class="dash-card-img-wrapper">
          <img src="dash_enquiries.png" alt="Enquiries">
        </div>
        <h2>Enquiry Records <span class="enquiry-badge"
            style="position:static; transform:none; display:inline-block; margin-left:8px;">●</span></h2>
        <p>Respond to new leads and queries from the landing page.</p>
      </div>
    </div>

    <!-- SEAT SECTION -->
    <div id="seatSection" style="display:none;">
      <button class="back-home-btn" onclick="showDashboardHome()">← Back to Dashboard</button>

      <div class="stats-container">
        <div class="stat-card glass-card">
          <div class="stat-avatar-wrapper">
            <img src="avatar_boy_3d.png" alt="Student Avatar" class="stat-avatar">
            <div class="verified-badge">✓</div>
          </div>
          <div class="stat-info">
            <h3>AC Section</h3>
            <p class="stat-subtitle">Premium Seating</p>
            <div class="stat-metrics">
              <div class="metric">
                <span class="metric-value" id="acBooked">0</span>
                <span class="metric-label">Booked</span>
              </div>
              <div class="metric">
                <span class="metric-value">30</span>
                <span class="metric-label">Total</span>
              </div>
              <div class="metric">
                <span class="metric-value" id="acAvailable">30</span>
                <span class="metric-label">Available</span>
              </div>
            </div>
          </div>
        </div>

        <div class="stat-card glass-card">
          <div class="stat-avatar-wrapper">
            <img src="avatar_girl_3d.png" alt="Student Avatar" class="stat-avatar">
            <div class="verified-badge">✓</div>
          </div>
          <div class="stat-info">
            <h3>Non AC Section</h3>
            <p class="stat-subtitle">Standard Seating</p>
            <div class="stat-metrics">
              <div class="metric">
                <span class="metric-value" id="nonBooked">0</span>
                <span class="metric-label">Booked</span>
              </div>
              <div class="metric">
                <span class="metric-value">25</span>
                <span class="metric-label">Total</span>
              </div>
              <div class="metric">
                <span class="metric-value" id="nonAvailable">25</span>
                <span class="metric-label">Available</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="section-wrapper">
        <h2>AC Section</h2>
        <div id="acSeats" class="seat-grid"></div>
      </div>

      <div class="section-wrapper">
        <h2>Non AC Section</h2>
        <div id="nonSeats" class="seat-grid"></div>
      </div>

      <button class="reset-btn" onclick="resetAll()">Reset All Seats</button>

    </div>

    <!-- ENQUIRY SECTION -->
    <div id="enquirySection" style="display:none;">
      <button class="back-home-btn" onclick="showDashboardHome()">← Back to Dashboard</button>
      <div class="section-wrapper">
        <h2 style="color:var(--text); font-family:var(--font-heading); text-transform:uppercase;">Enquiry Records</h2>
        <table class="enquiry-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Message</th>
              <th>Status</th>
              <th>Date</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="enquiryTable"></tbody>
        </table>
      </div>
    </div>

    <!-- USERS SECTION -->
    <div id="usersSection" style="display:none;">
      <button class="back-home-btn" onclick="showDashboardHome()">← Back to Dashboard</button>
      <div class="section-wrapper">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h2 style="color:var(--text); margin: 0; font-family:var(--font-heading); text-transform:uppercase;">
            Registered Users</h2>
          <button onclick="openAddUserModal()" class="mark-btn"
            style="padding: 10px 20px; font-size: 14px; text-transform:uppercase;">+ Add User</button>
        </div>
        <table class="enquiry-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Gender</th>
              <th>Seat</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="usersTable"></tbody>
        </table>
      </div>
    </div>

  </div>

  <!-- Student Details Modal -->
  <div id="studentModal" class="modal">
    <div class="modal-content" style="text-align: left; min-width: 350px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="margin: 0;">Space Details</h3>
        <button class="close-btn" onclick="closeStudentModal()">&times;</button>
      </div>

      <div id="studentDetailsContainer"
        style="max-height: 50vh; overflow-y: auto; margin-bottom: 10px; padding-right: 5px;">
        <!-- Dynamic Cards go here -->
      </div>
    </div>
  </div>

  <!-- Add User Modal for Admin -->
  <div id="addUserModal" class="modal">
    <div class="modal-content" style="text-align: left; min-width: 400px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="margin: 0; color: var(--text-main);">Add New Member</h3>
        <button class="close-btn" onclick="closeAddUserModal()">&times;</button>
      </div>

      <form id="adminAddUserForm" style="display: flex; flex-direction: column; gap: 15px;">
        <input type="text" id="adminRegName" required placeholder="Full Name">
        <input type="tel" id="adminRegPhone" required placeholder="Phone Number">

        <select id="adminRegGender" required>
          <option value="" disabled selected>Select Gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>

        <input type="text" id="adminRegSeat" required placeholder="Seat ID (e.g. AC_5)">
        <input type="text" id="adminRegDuration" required placeholder="Duration (e.g. 1 Month)">
        <button type="submit">Save User & Book Seat</button>
      </form>
    </div>
  </div>

  <!-- Subscription Closed Success Modal -->
  <div id="subscriptionClosedModal" class="modal">
    <div class="modal-content" style="text-align: center; max-width: 350px;">
      <div style="font-size: 60px; color: var(--accent-primary); margin-bottom: 15px;">✓</div>
      <h3 style="color: var(--text-main); margin-bottom: 10px;">Subscription Closed</h3>
      <p style="color: var(--text-muted); line-height: 1.5; margin-bottom: 20px;">The student's subscription has been
        marked as
        completed successfully.</p>
      <button onclick="closeSubscriptionModal()" style="width: 100%;">Done</button>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteConfirmModal" class="modal">
    <div class="modal-content" style="text-align: center; max-width: 350px;">
      <div style="font-size: 50px; color: #e74c3c; margin-bottom: 15px;">⚠️</div>
      <h3 style="color: var(--text-main); margin-bottom: 10px;">Delete User?</h3>
      <p style="color: var(--text-muted); line-height: 1.5; margin-bottom: 20px;">Are you sure you want to permanently
        delete this user? This action cannot be undone.</p>

      <div style="display: flex; gap: 10px;">
        <button onclick="closeDeleteConfirmModal()" style="background: var(--text-muted); width: 50%;">Cancel</button>
        <button onclick="confirmDeleteUser()" style="background: #e74c3c; width: 50%;">Delete</button>
      </div>
    </div>
  </div>

  <!-- Seat Click Custom Modal -->
  <div id="seatModal" class="error-modal" style="display:none; z-index: 2000;">
    <div class="error-content" style="text-align: center; max-width: 400px; padding: 40px; border-radius: 30px;">
      <div id="seatModalIcon"
        style="background:#10B981; margin: 0 auto 20px auto; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; color: white; box-shadow: 0 10px 20px rgba(16,185,129,0.2);">
        ℹ️</div>
      <h2
        style="font-size: 24px; color: var(--text-main); font-weight: 700; margin-bottom: 12px; letter-spacing: -0.5px;">
        Seat Info</h2>
      <p id="seatModalMessage"
        style="font-size: 15px; color: var(--text-muted); line-height: 1.6; margin-bottom: 30px;">This seat is empty.
      </p>
      <button onclick="closeSeatModal()" class="error-btn"
        style="background: var(--text-main); border: none; padding: 12px 30px; font-weight: 600; width: auto; margin: 0 auto; display: inline-block;">Got
        it</button>
    </div>
  </div>

  <!-- Login Error Modal -->
  <div id="loginErrorModal" class="error-modal">
    <div class="error-content">
      <div class="error-icon">✗</div>
      <h2>Invalid Login</h2>
      <p>The username or password you entered is incorrect. Please check your credentials and try again.</p>
      <button onclick="closeLoginErrorModal()" class="error-btn">Try Again</button>
    </div>
  </div>

  <script type="module" src="script.js"></script>
  <script>
    function updateClock() {
      const now = new Date();
      const time = now.toLocaleTimeString();
      document.getElementById("adminClock").innerText = time;
    }
    setInterval(updateClock, 1000);
    updateClock();
  </script>
</body>

</html>